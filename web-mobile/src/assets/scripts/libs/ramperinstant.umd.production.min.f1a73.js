!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).RamperInstant={})}(this,(function(e){"use strict";var n=function(){function e(e){this.listeners=new Map,this.listenerManager=e}var n=e.prototype;return n.addListener=function(e,n){this.listeners.set(e,n),this.listenerManager.add(e,n)},n.removeListener=function(e){var n=this.listeners.get(e);n&&(this.listenerManager.remove(e,n),this.listeners.delete(e))},n.on=function(e,n){this.removeListener(e),this.addListener(e,n)},n.once=function(e,n){var t=this;this.addListener(e,(function(o){n(o),t.removeListener(e)}))},n.off=function(e){this.listeners.has(e)&&this.removeListener(e)},n.clear=function(){var e=this;this.listeners.forEach((function(n,t){e.listenerManager.remove(t,n)})),this.listeners.clear()},e}(),t=function(){function e(e){var t=this;this.gameProfile={crendentialData:{credential:"",select_by:""},game_id:"game_id_test"},this.env={partner:"coin98",environment:"test"},this.ramperLoggedInUser=null,this.keyItemLoggedUser="ramper_loggedInUser",this._onRecieveMessageCallback=null,this.eventWrapper=new n({add:function(e,n){window.document.addEventListener(e,n)},remove:function(e,n){window.document.removeEventListener(e,n)}}),this.source=e,this.ramperLoggedInUser=localStorage.getItem(this.keyItemLoggedUser)?JSON.parse(localStorage.getItem("ramper_loggedInUser")):null,window.addEventListener("message",(function(e){var n;try{var o;n=JSON.parse(null==(o=e.data)?void 0:o.message)}catch(e){return}if(void 0!==e.data.action&&"cocosMethod"===e.data.action)switch(t._onRecieveMessageCallback&&t._onRecieveMessageCallback(n),n.eventName){case"sign_out_success":localStorage.removeItem("ramper_loggedInUser");break;case"sign_out_fail":case"sign_transaction_success":case"sign_transaction_fail":case"sign_message_success":case"sign_message_cancel":case"cancel":break;case"sign_in_success":localStorage.setItem(t.keyItemLoggedUser,JSON.stringify(n))}}))}var t=e.prototype;return t.emitCustomEvent=function(e,n){void 0===n&&(n={}),function(e,n,t){void 0===t&&(t=null);var o={type:e,source:n,data:t||{}};void 0!==window.top?window.top.postMessage(JSON.stringify(o),"*"):console.log("emit: "+JSON.stringify(o))}(e,this.source,n)},t.on=function(e,n){this.eventWrapper.on(e,this.transform(n))},t.off=function(e){this.eventWrapper.off(e)},t.once=function(e,n){this.eventWrapper.once(e,this.transform(n))},t.clear=function(){this.eventWrapper.clear()},t.clearCache=function(){localStorage.removeItem(this.keyItemLoggedUser),this.gameProfile={crendentialData:{credential:"",select_by:""},game_id:"game_id_test"},this.ramperLoggedInUser=null},t.transform=function(e){return function(n){var t=JSON.parse(n.detail);e(t)}},t.setOnRecieveMessageCallback=function(e){this._onRecieveMessageCallback=e},e}(),o=function(){function e(){}return e.parseParameters=function(e,n,t){if(void 0===t){var o="function"==typeof e;n?(t=n,o||(n=null)):null===n&&o&&(t=e,e=null,n=null),null!==n&&o&&(n=e,e=null)}return{options:e=e||Object.create(null),onProgress:n,onComplete:t}},e.downloadScriptWeb=function(n){return new Promise((function(t,o){var r=e.parseParameters(i,null,a),i=r.options,a=r.onComplete;if(e.downloaded[n])t();else{var s=document,c=document.createElement("script");c.async=i.async,c.src=n;var l=function(){var o;null==(o=c.parentNode)||o.removeChild(c),c.removeEventListener("load",l,!1),c.removeEventListener("error",d,!1),e.downloaded[n]=!0,t()},d=function(){var e;null==(e=c.parentNode)||e.removeChild(c),c.removeEventListener("load",l,!1),c.removeEventListener("error",d,!1),console.warn("ScriptDownloader:downloadScriptWeb - Cannot load "+n),o()};c.addEventListener("load",l,!1),c.addEventListener("error",d,!1),s.body.appendChild(c)}}))},e}();o.downloaded={};var r=function(){function e(){}return e.BaseURL=function(n){return void 0===n&&(n="test"),e.mapBaseUrl.get(n)},e.googleClientId=function(n){return void 0===n&&(n="test"),e.mapGoogleClientIds.get(n)},e}();r.FLAG_COCOS="isCocosForce=true",r.DEFAULT_CHAIN_NAME="tomo",r.SIGNIN_ENDPOINT="wallet/signin",r.SIGN_MESSAGE_ENDPOINT="unity/sign-message?"+r.FLAG_COCOS+"&message=",r.SIGN_TRANSACTION_ENDPOINT="unity/sign-transaction?"+r.FLAG_COCOS,r.SIGN_OUT="signout",r.mapBaseUrl=new Map([["test","https://ramper-v2-coin98-auth-test.coin98.dev/"],["staging","https://ramper-v2-eternals-auth-test.coin98.dev/"],["prod","https://auth-coin98.ramper.xyz/"]]),r.mapGoogleClientIds=new Map([["test","663197326394-ngu7bcpsbo6t6ampt433aqceei7mbhjm.apps.googleusercontent.com"],["staging","663197326394-ngu7bcpsbo6t6ampt433aqceei7mbhjm.apps.googleusercontent.com"],["prod","663197326394-ngu7bcpsbo6t6ampt433aqceei7mbhjm.apps.googleusercontent.com"]]);var i=new t("RamperInstant-1.0.0");function a(){return r.BaseURL(i.env.environment)+"test?credentialResponse="+i.gameProfile.crendentialData.credential+"&message=Welcome&partner="+i.env.partner+"&provider=google&"+r.FLAG_COCOS}e.doSignIn=function(e){if(i.ramperLoggedInUser)return e.url=a(),void(e.node.active=!0);google.accounts.id.initialize({client_id:r.googleClientId(i.env.environment),callback:function(n){i.gameProfile.crendentialData=n,e.url=a(),e.node.active=!0,console.log(e.url)}}),google.accounts.id.prompt()},e.doSignOut=function(e){e.url=""+r.BaseURL(i.env.environment)+r.SIGN_OUT+"?"+r.FLAG_COCOS,e.node.active=!0,console.log(e.url),i.clearCache()},e.getSDKVersion=function(){return"1.0.0"},e.initializeAsync=function(e,n){return new Promise((function(t){i.gameProfile.game_id=e.gameId,i.env.environment=e.serverEnv,i.env.partner=e.partner,i.setOnRecieveMessageCallback(n),o.downloadScriptWeb("https://accounts.google.com/gsi/client").then((function(e){t(e)}))}))},e.injectDebug=function(){o.downloadScriptWeb("https://unpkg.com/vconsole@3.15.1/dist/vconsole.min.js").then((function(){window.VConsole&&(window.vConsole=new VConsole)}))},e.injectIframe=function(){var e=document.createElement("iframe");e.id="myIframe",document.body.appendChild(e);var n=e.contentDocument||e.contentWindow.document;n.open(),n.write('\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          <title>Iframe Content</title>\n      </head>\n      <body>\n          <h1>Hello from Iframe!</h1>\n      </body>\n      </html>\n  '),n.close();var t=n.createElement("script");t.type="text/javascript",t.text="\n      document.body.style.backgroundColor = 'lightyellow';\n      console.log('JavaScript running inside the iframe');\n  ",n.body.appendChild(t)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ramperinstant.umd.production.min.js.map
